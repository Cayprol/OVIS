<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<record model="ir.ui.view" id="inherit_view_order_form">
			<field name="model">sale.order</field>
			<field name="name">inherit.sale.order.form</field>
			<field name="inherit_id" ref="sale.view_order_form"/>
			<field name="arch" type="xml">

				<xpath expr="//field[@name='sale_order_template_id']" position="after">
					<field name="quotation_id" class="oe_edit_only" options="{'no_create': True}" context="{'show_total_amount': True}"/>
				</xpath>

				<xpath expr="//header/button[@id='action_confirm']" position="before">
					<button name="action_ask_approve" id="action_ask_approve" states='draft' string="Ask Approval" type="object" class="btn-primary" groups="sales_team.group_sale_salesman"/>
					<button name="action_approve" id="action_approve" states='to approve' string="Approve Quotation" type="object" class="btn-primary" groups="sales_team.group_sale_manager"/>
				</xpath>

				<xpath expr="//header/button[@name='action_confirm'][2]" position="replace"/>
 
				<xpath expr="//header/button[@name='action_quotation_send' and @class='btn-primary'][1]" position="replace"/>
				<xpath expr="//header/button[@name='action_quotation_send'][1]" position="replace"/>
				<xpath expr="//header/button[@name='action_quotation_send'][2]" position="replace"/>
				<xpath expr="//header/button[@name='action_quotation_send' and @groups='sale.group_proforma_sales']" position="replace"/>

 				<xpath expr="//group[@name='sale_pay']" position="after">
					<group string="Validation" name='validation'>
						<field name="ask_approve_date"/>
						<field name="approve_date"/>
						<field name="approver_id"/>
					</group>

				</xpath>

				<xpath expr="//field[@name='state']" position="attributes">
					<attribute name="statusbar_visible">draft,to approve,sent,sale</attribute>
				</xpath>

			</field>
		</record>


		<record id="inherit_sale_order_view_search_inherit_quotation" model="ir.ui.view" >
			<field name="model">sale.order</field>
			<field name="name">inherit.sale.order.search.inherit.quotation</field>
			<field name="inherit_id" ref="sale.sale_order_view_search_inherit_quotation"/>
			<field name="arch" type="xml">
				
				<!-- Add Filter for sale order in state 'to approve' -->
				<xpath expr="//filter[@name='draft']" position="after">
					<filter string="To Approve" name="to_approve" domain="[('state', '=', 'to approve')]"/>
					<filter string="Sent" name="sent" domain="[('state', '=', 'sent')]"/>
				</xpath>

			</field>
		</record>
	</data>
</odoo>